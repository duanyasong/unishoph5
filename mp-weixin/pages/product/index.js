(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/index"],{"15a9":function(t,a,e){"use strict";e.r(a);var i=e("3872"),s=e.n(i);for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);a["default"]=s.a},"253f":function(t,a,e){"use strict";e.r(a);var i=e("deb6"),s=e("15a9");for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);e("74d6");var c=e("2877"),o=Object(c["a"])(s["default"],i["a"],i["b"],!1,null,null,null);a["default"]=o.exports},3872:function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=s(e("55ef"));function s(t){return t&&t.__esModule?t:{default:t}}function n(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var c=e("3b97"),o=0,r=!0,u=0,d="list-side-item-active",l={components:{mtFooter:i.default},data:function(){return{pageLoad:!1,pageHide:!1,pageData:{},winHeight:600,defaultActive:"list-side-item-active"}},onLoad:function(a){var e=t.getSystemInfoSync();this.winHeight=e.windowHeight-50,t.setNavigationBarTitle({title:"产品"}),this.getPage()},onShow:function(){this.pageHide&&(this.pageHide=!1,this.getPage())},onHide:function(){this.pageHide=!0},onPullDownRefresh:function(){this.refresh()},onReachBottom:function(){this.getList()},methods:{getPage:function(){var a=this;t.request({url:c.apiHost+"?m=product&ajax=1",data:{authcode:c.getAuthCode()},success:function(t){r=!1,a.pageLoad=!0,a.pageData=t.data.data,o=t.data.data.per_page}})},setCat:function(t){u=t,r=!0,o=0,this.defaultActive=0==u?d:"";var a=this.pageData.catlist;for(var e in a)a[e].id==u?a[e].isactive=1:a[e].isactive=0;this.pageData.catlist=a,this.getList()},getList:function(){var a=this;if(!r&&0==o)return!1;t.request({url:c.apiHost+"?m=product&ajax=1",data:{per_page:o,shop_cid:u,authcode:c.getAuthCode()},success:function(t){t.data.error||(r?(a.pageData.list=t.data.data.list,r=!1):a.pageData.list=c.json_add(a.pageData.list,t.data.data.list),o=t.data.data.per_page)}})},goProduct:function(a){t.navigateTo({url:"/pages/product/show?id="+a})},refresh:function(){this.getPage(),setTimeout(function(){t.stopPullDownRefresh()},1e3)},loadMore:function(){this.getList()},addCart:function(a,e){var i=this;a=a,e=void 0==e?0:e;t.request({url:c.apiHost+"?m=order_cart&a=add&fromapp=wxapp&ajax=1&object_id="+a,data:{authcode:c.getAuthCode(),ksid:e},method:"GET",success:function(t){console.log(t.data.data.product_amount);for(var e=i.pageData.list,s=0;s<e.length;s++)if(e[s].id==a){e[s].cart_num=t.data.data.product_amount;break}i.pageData.list=i.parseList(e)}})},plusCart:function(a,e,i){var s=this;a=a,e=e,i=void 0==i?0:i;e++,t.request({url:c.apiHost+"?m=order_cart&a=add&fromapp=wxapp&ajax=1",data:{authcode:c.getAuthCode(),object_id:a,amount:e,isplus:1,ksid:i},method:"GET",success:function(t){for(var e=s.pageData.list,i=0;i<e.length;i++)if(e[i].id==a){e[i].cart_num=t.data.data.product_amount;break}s.pageData.list=s.parseList(e)}})},minusCart:function(a,e,i){var s=this;a=a,e=e;e--;var o=0;0==e&&(o=1),t.request({url:c.apiHost+"?m=order_cart&a=add&fromapp=wxapp&ajax=1",data:n({authcode:c.getAuthCode(),amount:e,isdelete:o,isminus:1,object_id:a},"amount",e),method:"GET",success:function(t){for(var e=s.pageData.list,i=0;i<e.length;i++)if(e[i].id==a){e[i].cart_num=t.data.data.product_amount;break}s.pageData.list=s.parseList(e)}})},parseList:function(t){for(var a=0;a<t.length;a++)t[a].cart_num>0?t[a].cart_num_class="prolist-item-row-cart-active":t[a].cart_num_class="";return t}}};a.default=l}).call(this,e("543d")["default"])},6127:function(t,a,e){"use strict";e("53c4");var i=n(e("b0ce")),s=n(e("253f"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))},"74d6":function(t,a,e){"use strict";var i=e("d371"),s=e.n(i);s.a},d371:function(t,a,e){},deb6:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.pageLoad?e("view",{staticClass:"flex"},[e("view",{staticClass:"list-side"},[e("view",{staticClass:"list-side-item",class:t.defaultActive,attrs:{eventid:"0a1b3ccb-0"},on:{click:function(a){t.setCat(0)}}},[t._v("推荐")]),t._l(t.pageData.catlist,function(a,i){return e("view",{key:i,staticClass:"list-side-item",class:{"list-side-item-active":a.isactive},attrs:{eventid:"0a1b3ccb-1-"+i},on:{click:function(e){t.setCat(a.id)}}},[t._v(t._s(a.title))])})],2),e("view",{staticClass:"flex-main bg-fff"},t._l(t.pageData.list,function(a,i){return e("view",{key:i,staticClass:"prolist-item"},[e("image",{staticClass:"prolist-img",attrs:{src:a.imgurl+".100x100.jpg",eventid:"0a1b3ccb-2-"+i},on:{click:function(e){t.goProduct(a.id)}}}),e("view",{staticClass:"prolist-flex-1"},[e("view",{staticClass:"prolist-title",attrs:{eventid:"0a1b3ccb-3-"+i},on:{click:function(e){t.goProduct(a.id)}}},[t._v(t._s(a.title))]),e("view",{staticClass:"prolist-row-price"},[t._v("价格："),e("text",{staticClass:"prolist-price"},[t._v("￥"+t._s(a.price))]),e("view",{staticClass:"flex-1"}),e("view",{staticClass:"fr cor2"},[t._v(t._s(a.buy_num)+"件已售")])]),e("view",{staticClass:"prolist-cart"},[e("view",{staticClass:"flex-1"}),a.isksid?e("view",[0==a.cart_num?e("view",{staticClass:"prolist-buy-btn",attrs:{eventid:"0a1b3ccb-4-"+i},on:{click:function(e){t.addCart(a.id)}}},[t._v("选规格")]):t._e()]):e("view",{staticClass:"pdb-5"},[a.cart_num>0?e("view",{staticClass:"numbox prolist-numbox"},[e("view",{staticClass:"numbox-minus",attrs:{eventid:"0a1b3ccb-5-"+i},on:{click:function(e){t.minusCart(a.id,a.cart_num)}}},[t._v("-")]),e("input",{staticClass:"numbox-num",attrs:{type:"text",name:"amount",value:a.cart_num}}),e("view",{staticClass:"numbox-plus",attrs:{eventid:"0a1b3ccb-6-"+i},on:{click:function(e){t.plusCart(a.id,a.cart_num)}}},[t._v("+")])]):t._e(),0==a.cart_num?e("view",{staticClass:"prolist-buy-btn",attrs:{eventid:"0a1b3ccb-7-"+i},on:{click:function(e){t.addCart(a.id)}}},[t._v("买")]):t._e()])])])])}))]):t._e()},s=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return s})}},[["6127","common/runtime","common/vendor"]]]);